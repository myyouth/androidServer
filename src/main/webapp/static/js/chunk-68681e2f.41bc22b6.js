(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68681e2f"],{"0e5e":function(e,t,a){},"144b":function(e,t,a){},"365c":function(e,t,a){"use strict";var l=a("bc3a"),i=a.n(l),s=i.a.create({timeout:5e3});s.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject()})),s.interceptors.response.use((function(e){if(200===e.status)return e.data;Promise.reject()}),(function(e){return console.log(e),Promise.reject()}));var n=s;a.d(t,"a",(function(){return r}));var r=function(e){return n({url:"./table.json",method:"get",params:e})}},"48ff":function(e,t,a){"use strict";var l=a("f273"),i=a.n(l);i.a},5527:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("基本信息")])]),a("el-form",{ref:"form",staticStyle:{width:"300px"},attrs:{model:e.form,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"业务对象名称",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[a("el-option",{key:"SLTZD",attrs:{label:"收料通知单",value:"SLTZD"}}),a("el-option",{key:"SCHBD",attrs:{label:"生产汇报单",value:"SCHBD"}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("选单")]),a("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1)],1)],1)],1)],1),a("el-row",[a("el-col",[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("源单明细")])]),a("v-sourceDetail",{ref:"source",on:{callBack:e.createBarcode}})],1)],1)],1),a("el-row",[a("el-col",[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("条码明细")])]),a("v-barcodeDetail",{ref:"barcode"})],1)],1)],1),a("el-dialog",{attrs:{title:"查询",visible:e.dialogTableVisible,width:"40%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"title"},slot:"title"},[a("span",{staticStyle:{"font-size":"30px"}},[e._v("查询")]),a("div",{staticClass:"line"})]),a("v-search",{ref:"search",on:{callBack:e.getSourceData,error:e.setDialog}})],1)],1)},i=[],s=(a("7f7f"),a("386d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v("批量删除")]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-finished"},on:{click:e.createBarcode}},[e._v("生成条码")]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete-solid"},on:{click:e.clearData}},[e._v("清空列表")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header",height:"350"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._e(),a("el-table-column",{attrs:{prop:"mNumber",label:"物料编码"}}),a("el-table-column",{attrs:{prop:"mName",label:"物料名称"}}),a("el-table-column",{attrs:{prop:"lSum",label:"生成数"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.setlSum(t.row)))])]}}])}),a("el-table-column",{attrs:{prop:"mSum",label:"数量",width:"155"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{min:1},model:{value:t.row.mSum,callback:function(a){e.$set(t.row,"mSum",a)},expression:"scope.row.mSum"}})]}}])}),a("el-table-column",{attrs:{prop:"minSum",label:"最小包装数",width:"155"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input-number",{attrs:{min:1},model:{value:t.row.minSum,callback:function(a){e.$set(t.row,"minSum",a)},expression:"scope.row.minSum"}})]}}])}),a("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),a("el-table-column",{attrs:{prop:"type",label:"单据类型"}}),a("el-table-column",{attrs:{prop:"typeNumber",label:"单据编号"}}),a("el-table-column",{attrs:{prop:"batch",label:"批次号"}}),a("el-table-column",{attrs:{prop:"supplier",label:"供应商",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{readonly:""},model:{value:t.row.supplier,callback:function(a){e.$set(t.row,"supplier",a)},expression:"scope.row.supplier"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:function(a){return e.getSupply(t.row)}},slot:"prefix"})])]}}])}),a("el-table-column",{attrs:{prop:"workShop",label:"生产车间"}}),a("el-table-column",{attrs:{prop:"warehouse",label:"仓库",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{readonly:""},model:{value:t.row.warehouse,callback:function(a){e.$set(t.row,"warehouse",a)},expression:"scope.row.warehouse"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:function(a){return e.getWareHourse(t.row)}},slot:"prefix"})])]}}])}),a("el-table-column",{attrs:{prop:"position",label:"仓位"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{readonly:""},model:{value:t.row.position,callback:function(a){e.$set(t.row,"position",a)},expression:"scope.row.position"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},on:{click:function(a){return e.getPosition(t.row)}},slot:"prefix"})])]}}])}),e._e()],1),a("el-dialog",{attrs:{title:"查询",visible:e.selectVisible,width:"40%"},on:{"update:visible":function(t){e.selectVisible=t}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"title"},slot:"title"},[a("span",{staticStyle:{"font-size":"30px"}},[e._v("查询")]),a("div",{staticClass:"line"})]),a("v-search",{ref:"search",on:{callBack:e.setSearchValue}})],1)],1)}),n=[],r=(a("ac6a"),a("365c")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete-solid"},on:{click:e.returnData}},[e._v("返回数据")]),a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"选项"},model:{value:e.query.param,callback:function(t){e.$set(e.query,"param",t)},expression:"query.param"}},[a("el-option",{key:"number",attrs:{label:"编码",value:"number"}}),a("el-option",{key:"name",attrs:{label:"名称",value:"name"}})],1),a("el-input",{staticClass:"handle-input mr10",model:{value:e.query.value,callback:function(t){e.$set(e.query,"value",t)},expression:"query.value"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header",height:"350"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._e(),a("el-table-column",{attrs:{prop:"mNumber",label:"编码"}}),a("el-table-column",{attrs:{prop:"mName",label:"名称"}})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1)},c=[],u=(a("c5f6"),{name:"search",data:function(){return{query:{pageIndex:1,pageSize:10,param:"",value:""},pageTotal:0,tableData:[],multipleSelection:[],selectVisible:!1,loading:!0,typeDoc:"",flag:!0}},methods:{getData:function(){var e=this;Object(r["a"])(this.query).then((function(t){e.tableData=t.list,e.pageTotal=t.pageTotal||50}))},handleSelectionChange:function(e){this.multipleSelection=e},returnData:function(){if(this.flag&&1!=this.multipleSelection.length)this.$message.error("返回数据必须唯一");else{var e={};e.selection=this.multipleSelection,-1!=this.typeDoc.indexOf("&&&")?e.type=this.typeDoc.substring(0,this.typeDoc.indexOf("&&&")):e.type=this.typeDoc,this.$emit("callBack",e)}},search:function(e){this.tableData=[],this.typeDoc=e,this.loading=!1,this.query.param="",this.query.value="",this.$set(this.query,"pageIndex",1),this.flag=!0},searchForMore:function(e){this.typeDoc=e,this.loading=!0,this.query.param="",this.query.value="",this.$set(this.query,"pageIndex",1),this.selectAllData(),this.flag=!1},handlePageChange:function(e){this.loading=!0,this.$set(this.query,"pageIndex",e),this.selectAllData()},handleSearch:function(){this.loading=!0,this.$set(this.query,"pageIndex",1),this.selectAllData()},selectAllData:function(){var e=this;this.$api.get("/selectAllDoc",{typeDoc:this.typeDoc,query:this.query},(function(t){if(t.status>=200&&t.status<300)if("true"==t.data.success){e.tableData=t.data.data;var a=Number(t.data.pageTotal);a||(a=0),e.pageTotal=a,e.loading=!1}else e.$message.error("数据查询失败，请联系管理员！"),e.$emit("error",!1);else e.loading=!1,e.$message.error("数据查询失败，请联系管理员！"),e.$emit("error",!1)}))}}}),d=u,h=(a("a7d8"),a("2877")),p=Object(h["a"])(d,o,c,!1,null,"2cd40581",null),m=p.exports,b={name:"sourceTable",data:function(){return{query:{},tableData:[],multipleSelection:[],selectVisible:!1,editIndex:-1,loading:!1}},components:{vSearch:m},created:function(){this.tableData=[]},methods:{getData:function(){var e=this;Object(r["a"])(this.query).then((function(t){e.tableData=t.list}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){for(var e=this.multipleSelection.length,t=e;t>0;t--)console.log(this.multipleSelection[t-1].id),this.tableData.splice(this.multipleSelection[t-1].id-1,1);for(var a=1;a<=this.tableData.length;a++)this.$set(this.tableData[a-1],"id",a);this.$message.success("删除成功！"),this.multipleSelection=[]},clearData:function(){this.$message.success("清空成功！"),this.tableData=[]},setlSum:function(e){return e.lSum=Math.ceil(e.mSum/e.minSum),e.lSum},getWareHourse:function(e){var t=this;this.editIndex=e.id,this.selectVisible=!0,this.$nextTick((function(){t.$refs.search.search("CK")}))},getPosition:function(e){var t=this;this.editIndex=e.id,0!=e.warehouseId.length?(this.selectVisible=!0,this.$nextTick((function(){t.$refs.search.search("CW&&&"+e.warehouseId)}))):this.$message.error("请先选择仓库")},getSupply:function(e){var t=this;this.editIndex=e.id,this.selectVisible=!0,this.$nextTick((function(){t.$refs.search.search("GYS")}))},searchMaterial:function(){var e=this;this.selectVisible=!0,this.$nextTick((function(){e.$refs.search.searchForMore("WL")}))},setSearchValue:function(e){var t=this;this.selectVisible=!1,"CK"==e.type?this.tableData.forEach((function(a){a.id==t.editIndex&&(t.$set(a,"warehouse",e.selection[0].mName),t.$set(a,"warehouseId",e.selection[0].id))})):"CW"==e.type?this.tableData.forEach((function(a){a.id==t.editIndex&&(t.$set(a,"position",e.selection[0].mName),t.$set(a,"positionId",e.selection[0].id))})):"GYS"==e.type?this.tableData.forEach((function(a){a.id==t.editIndex&&(t.$set(a,"supplier",e.selection[0].mName),t.$set(a,"supplierId",e.selection[0].id))})):"WL"==e.type&&(this.loading=!0,this.$api.post("/selectAllMaterial",{typeDoc:e.type,mNumber:JSON.stringify(e.selection)},(function(e){if(e.status>=200&&e.status<300)if("true"==e.data.success){var a=t.tableData.length;e.data.data.forEach((function(e){e.id=a+1,t.tableData.push(e),a++})),t.loading=!1}else t.$message.error("数据获取失败，请联系管理员！");else t.loading=!1,t.$message.error("数据获取失败，请联系管理员！")})))},getDataBase:function(e){var t=this;this.loading=!0,this.$api.get("/selectAllMaterial",{typeDoc:e.type,mNumber:e.selection[0].mNumber},(function(e){e.status>=200&&e.status<300?"true"==e.data.success?(t.tableData=e.data.data,t.loading=!1):t.$message.error("数据获取失败，请联系管理员！"):(t.loading=!1,t.$message.error("数据获取失败，请联系管理员！"))}))},createBarcode:function(){this.$emit("callBack",this.multipleSelection)}}},f=b,g=(a("d51b"),Object(h["a"])(f,s,n,!1,null,"42afde46",null)),v=g.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.delAllSelection}},[e._v("批量删除")]),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete-solid"},on:{click:e.clearData}},[e._v("清空列表")]),a("el-select",{staticClass:"handle-del mr10",attrs:{placeholder:"请选择打印机"},model:{value:e.printMachine,callback:function(t){e.printMachine=t},expression:"printMachine"}},e._l(e.machineList,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})})),1),a("el-select",{staticClass:"handle-del mr10",attrs:{placeholder:"请选择条码模板"},model:{value:e.labelName,callback:function(t){e.labelName=t},expression:"labelName"}},[a("el-option",{key:"1",attrs:{label:"原料标签",value:"1"}}),a("el-option",{key:"2",attrs:{label:"产成品标签",value:"2"}}),a("el-option",{key:"3",attrs:{label:"小包装标签",value:"3"}})],1),a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-printer"},on:{click:e.printBarcode}},[e._v("打印条码")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.tableData,border:"","header-cell-class-name":"table-header",height:"350"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"materielNumber",label:"物料编码"}}),a("el-table-column",{attrs:{prop:"materialName",label:"物料名称"}}),a("el-table-column",{attrs:{prop:"barcodNumber",label:"条码编码"}}),a("el-table-column",{attrs:{prop:"materialQty",label:"数量"}}),a("el-table-column",{attrs:{prop:"typeName",label:"单据类型"}}),a("el-table-column",{attrs:{prop:"typeNumber",label:"单据编号"}}),a("el-table-column",{attrs:{prop:"materialBatch",label:"批次号"}}),a("el-table-column",{attrs:{prop:"supplyName",label:"供应商"}}),a("el-table-column",{attrs:{prop:"stockName",label:"仓库"}}),a("el-table-column",{attrs:{prop:"stockPlaceName",label:"仓位"}})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageIndex,"page-size":e.query.pageSize,total:e.pageTotal},on:{"current-change":e.handlePageChange}})],1)],1)},S=[],D=a("bd86"),$={name:"sourceTable",data:function(){return Object(D["a"])({barcodeNumbers:[],query:{pageIndex:1,pageSize:10},tableData:[],tableDataCreate:[],multipleSelection:[],selectVisible:!1,pageTotal:0,labelName:"",loading:!1,machineList:[],printMachine:""},"loading",!1)},created:function(){this.tableData=this.baseData,this.getPrintMachineList()},methods:{getData:function(){var e=this;Object(r["a"])(this.query).then((function(t){e.tableData=t.list}))},handleSelectionChange:function(e){this.multipleSelection=e},delAllSelection:function(){for(var e=this.multipleSelection.length,t=0;t<e;t++)this.tableData.splice(this.multipleSelection[t].index,1);this.$message.success("删除成功！"),this.multipleSelection=[]},clearData:function(){this.$message.success("清空成功！"),this.tableData=[]},getDataBase:function(e){var t=this;this.loading=!0,this.$api.post("/createBarcode",{jsonData:JSON.stringify(e)},(function(e){if(e.status>=200&&e.status<300)if("true"==e.data.success){t.tableDataCreate=e.data.data;var a=Number(e.data.pageTotal);a||(a=0),t.pageTotal=a,t.tableData=t.tableDataCreate.slice(0,t.query.pageSize),t.loading=!1}else t.loading=!1,t.$message.error("数据获取失败，请联系管理员！");else t.loading=!1,t.$message.error("数据获取失败，请联系管理员！")}))},printBarcode:function(){var e=this;if(this.loading=!0,0==this.printMachine.length||0==this.labelName.length||0==this.multipleSelection.length)return this.loading=!1,this.$message.error("请选择打印机、打印模板及打印条码");this.barcodeNumbers=[],this.multipleSelection.some((function(t,a){e.barcodeNumbers.push(t.barcodNumber)})),console.log(this.barcodeNumbers),this.$api.post("/printBarcode",{jsonData:JSON.stringify(this.barcodeNumbers),printMachine:this.printMachine,labelName:this.labelName},(function(t){e.loading=!1,t.status>=200&&t.status<300?(e.loading=!1,"true"==t.data.success?e.$message.success(t.data.msg):e.$message.error(t.data.msg)):e.$message.error("打印机连接失败！")}))},handlePageChange:function(e){this.tableData=this.tableDataCreate.slice((e-1)*this.query.pageSize,e*this.query.pageSize)},getPrintMachineList:function(){var e=this;this.$api.post("/getPrintMachineList",{},(function(t){t.status>=200&&t.status<300&&"true"==t.data.success?(e.machineList=JSON.parse(t.data.data),e.$message.success("打印机获取成功！")):e.$message.error("打印机获取失败，请联系管理员！")}))}}},x=$,w=(a("8d82"),Object(h["a"])(x,y,S,!1,null,"4b14b7dd",null)),k=w.exports,C={name:"print",data:function(){return{editVisible:!1,form:{number:"",name:"",labelName:""},dialogTableVisible:!1}},components:{vSourceDetail:v,vBarcodeDetail:k,vSearch:m},methods:{getData:function(){var e=this;fetchData(this.query).then((function(t){console.log(t),e.tableData=t.list,e.pageTotal=t.pageTotal||50}))},onSubmit:function(){var e=this;this.dialogTableVisible=!0,this.$nextTick((function(){e.$refs.search.search(e.form.name)}))},onCancel:function(){this.form.number="",this.form.name="",this.form.labelName=""},getSourceData:function(e){this.dialogTableVisible=!1,this.$refs.source.getDataBase(e)},createBarcode:function(e){this.$refs.barcode.getDataBase(e)},setDialog:function(e){this.dialogTableVisible=e}}},N=C,_=(a("48ff"),Object(h["a"])(N,l,i,!1,null,"0c5b3318",null));t["default"]=_.exports},5634:function(e,t,a){},"8d82":function(e,t,a){"use strict";var l=a("5634"),i=a.n(l);i.a},a7d8:function(e,t,a){"use strict";var l=a("0e5e"),i=a.n(l);i.a},d51b:function(e,t,a){"use strict";var l=a("144b"),i=a.n(l);i.a},f273:function(e,t,a){}}]);