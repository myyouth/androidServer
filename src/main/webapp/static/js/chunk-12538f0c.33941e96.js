(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12538f0c"],{"365c":function(e,s,r){"use strict";var t=r("bc3a"),i=r.n(t),a=i.a.create({timeout:5e3});a.interceptors.request.use((function(e){return e}),(function(e){return console.log(e),Promise.reject()})),a.interceptors.response.use((function(e){if(200===e.status)return e.data;Promise.reject()}),(function(e){return console.log(e),Promise.reject()}));var o=a;r.d(s,"a",(function(){return l}));var l=function(e){return o({url:"./table.json",method:"get",params:e})}},"89f8":function(e,s,r){"use strict";r.r(s);var t=function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("div",[r("div",{staticClass:"crumbs"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[r("i",{staticClass:"el-icon-user"}),e._v(" 用户设置 ")])],1)],1),r("div",{staticClass:"container"},[r("div",{staticClass:"handle"},[r("el-form",{ref:"roleForm",attrs:{model:e.roleForm,"label-width":"65px"}},[r("el-form-item",{attrs:{label:"角色：",prop:"roleId",rules:[{required:!0}]}},[r("el-select",{staticClass:"handle-select",attrs:{placeholder:"请选择角色",filterable:""},on:{change:e.changeRole},model:{value:e.roleForm.roleId,callback:function(s){e.$set(e.roleForm,"roleId",s)},expression:"roleForm.roleId"}},e._l(e.roleList,(function(e){return r("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})})),1)],1)],1),r("el-tabs",{attrs:{"before-leave":e.tabClick},model:{value:e.activeName,callback:function(s){e.activeName=s},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"用户",name:"first"}},[r("el-button",{staticClass:"handle-cre mr10",attrs:{type:"primary",icon:"el-icon-s-custom"},on:{click:e.createUser}},[e._v("新增角色用户")]),r("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.deleteUser}},[e._v("删除角色用户")]),r("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"选项"},model:{value:e.userQuery.param,callback:function(s){e.$set(e.userQuery,"param",s)},expression:"userQuery.param"}},[r("el-option",{key:"number",attrs:{label:"用户编码",value:"number"}}),r("el-option",{key:"name",attrs:{label:"用户名称",value:"name"}})],1),r("el-input",{staticClass:"handle-input mr10",model:{value:e.userQuery.value,callback:function(s){e.$set(e.userQuery,"value",s)},expression:"userQuery.value"}}),r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleUserSearch}},[e._v("搜索")]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.userLoading,expression:"userLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.userData,border:"","header-cell-class-name":"table-header",height:"350"},on:{"selection-change":e.handleUserSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._e(),r("el-table-column",{attrs:{prop:"userNumber",label:"用户编码"}}),r("el-table-column",{attrs:{prop:"userName",label:"用户名称"}}),r("el-table-column",{attrs:{prop:"userTime",label:"创建日期"}})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.userQuery.pageIndex,"page-size":e.userQuery.pageSize,total:e.userPageTotal},on:{"current-change":e.handleUserPageChange}})],1)],1),r("el-tab-pane",{attrs:{label:"权限",name:"second"}},[r("el-button",{staticClass:"handle-cre mr10",attrs:{type:"primary",icon:"el-icon-s-claim"},on:{click:e.createPermission}},[e._v("新增权限")]),r("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-delete"},on:{click:e.deletePermission}},[e._v("删除权限")]),r("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"选项"},model:{value:e.permissionQuery.param,callback:function(s){e.$set(e.permissionQuery,"param",s)},expression:"permissionQuery.param"}},[r("el-option",{key:"name",attrs:{label:"用户名称",value:"name"}})],1),r("el-input",{staticClass:"handle-input mr10",model:{value:e.permissionQuery.value,callback:function(s){e.$set(e.permissionQuery,"value",s)},expression:"permissionQuery.value"}}),r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handlePermissionSearch}},[e._v("搜索")]),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.permissionLoading,expression:"permissionLoading"}],ref:"multipleTable",staticClass:"table",attrs:{data:e.permissionData,border:"","header-cell-class-name":"table-header",height:"350"},on:{"selection-change":e.handlePermissionSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),e._e(),r("el-table-column",{attrs:{prop:"permissionName",label:"权限名称"}}),r("el-table-column",{attrs:{prop:"permissionTime",label:"创建日期"}})],1),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.permissionQuery.pageIndex,"page-size":e.permissionQuery.pageSize,total:e.permissionPageTotal},on:{"current-change":e.handlePermissionPageChange}})],1)],1)],1)],1)]),r("el-dialog",{attrs:{title:"新增角色用户",visible:e.dialogUserFormVisible,width:"600px"},on:{"update:visible":function(s){e.dialogUserFormVisible=s}}},[r("el-form",{ref:"userForm",staticClass:"userForm",attrs:{model:e.userForm,"status-icon":"","label-width":"100px","label-position":e.labelPosition}},[r("el-form-item",{attrs:{label:"用户名称",prop:"userId",rules:[{required:"true",trigger:"blur",message:"用户不能为空"}]}},[r("el-select",{staticClass:"handle-select mr12",attrs:{placeholder:"请选择用户",filterable:"",multiple:""},model:{value:e.userForm.userId,callback:function(s){e.$set(e.userForm,"userId",s)},expression:"userForm.userId"}},e._l(e.userList,(function(e){return r("el-option",{key:e.userId,attrs:{label:e.userName,value:e.userId}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.submitForm("userForm")}}},[e._v("提交")]),r("el-button",{on:{click:function(s){return e.resetForm("userForm")}}},[e._v("重置")])],1)],1)],1),r("el-dialog",{attrs:{title:"新增角色权限",visible:e.dialogPermissionFormVisible,width:"600px"},on:{"update:visible":function(s){e.dialogPermissionFormVisible=s}}},[r("el-form",{ref:"permissionForm",staticClass:"permissionForm",attrs:{model:e.permissionForm,"status-icon":"","label-width":"100px","label-position":e.labelPosition}},[r("el-form-item",{attrs:{label:"权限名称",prop:"permissionId",rules:[{required:"true",message:"权限不能为空",trigger:"blur"}]}},[r("el-select",{staticClass:"handle-select mr12",attrs:{placeholder:"请选择权限",filterable:"",multiple:""},model:{value:e.permissionForm.permissionId,callback:function(s){e.$set(e.permissionForm,"permissionId",s)},expression:"permissionForm.permissionId"}},e._l(e.permissionList,(function(e){return r("el-option",{key:e.permissionId,attrs:{label:e.permissionName,value:e.permissionId}})})),1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.submitForm("permissionForm")}}},[e._v("提交")]),r("el-button",{on:{click:function(s){return e.resetForm("permissionForm")}}},[e._v("重置")])],1)],1)],1)],1)},i=[],a=(r("c5f6"),r("365c"),{name:"userRoleManager",data:function(){return{roleForm:{roleId:""},roleList:[],roleId:"",userList:[],activeName:"",userQuery:{pageIndex:1,pageSize:10,param:"",value:""},userPageTotal:0,userData:[],userMultipleSelection:[],userLoading:!1,userForm:{userId:""},userId:"",dialogUserFormVisible:!1,permissionList:[],permissionQuery:{pageIndex:1,pageSize:10,param:"",value:""},permissionPageTotal:0,permissionData:[],permissionMultipleSelection:[],permissionLoading:!1,permissionForm:{permissionId:""},dialogPermissionFormVisible:!1,labelPosition:"right"}},created:function(){this.selectAllData()},methods:{selectAllData:function(){var e=this;this.$api.get("/searchAllRoleInfoForUser",{},(function(s){s.status>=200&&s.status<300&&"true"==s.data.success?e.roleList=JSON.parse(s.data.data):e.$message.error("角色查询失败，请联系管理员！")})),this.$api.get("/searchAllUserInfoForRole",{},(function(s){s.status>=200&&s.status<300&&"true"==s.data.success?e.userList=JSON.parse(s.data.data):e.$message.error("用户查询失败，请联系管理员！")})),this.$api.get("/searchAllPermissionInfoForRole",{},(function(s){s.status>=200&&s.status<300&&"true"==s.data.success?e.permissionList=JSON.parse(s.data.data):e.$message.error("用户查询失败，请联系管理员！")}))},changeRole:function(){this.activeName="first",this.selectInfoInRole("user"),this.selectInfoInRole("permission")},tabClick:function(){if(""===this.roleForm.roleId)return!1},submitForm:function(e){var s=this;0!=this.roleForm.roleId.length?this.$refs[e].validate((function(r){if(!r)return!1;"userForm"===e?(s.userLoading=!0,s.$api.post("/createUsersInRole",{roleId:s.roleForm.roleId,users:JSON.stringify(s.userForm.userId)},(function(r){r.status>=200&&r.status<300&&"true"==r.data.success?(s.$message.success(r.data.msg),s.dialogUserFormVisible=!1,s.selectInfoInRole("user"),s.resetForm(e)):(s.userLoading=!1,s.$message.error(r.data.msg))}))):"permissionForm"===e&&(s.permissionLoading=!0,s.$api.post("/createPermissionsInRole",{roleId:s.roleForm.roleId,permissions:JSON.stringify(s.permissionForm.permissionId)},(function(r){r.status>=200&&r.status<300&&"true"==r.data.success?(s.$message.success(r.data.msg),s.dialogPermissionFormVisible=!1,s.selectInfoInRole("permission"),s.resetForm(e)):(s.permissionLoading=!1,s.$message.error(r.data.msg))})))})):this.$message.error("请选择角色！")},selectInfoInRole:function(e){var s=this;"user"===e?(this.$set(this.userQuery,"roleId",this.roleForm.roleId),this.$api.get("/searchAllUseInfoInRole",{query:this.userQuery},(function(e){if(e.status>=200&&e.status<300)if("true"==e.data.success){s.userData=e.data.data;var r=Number(e.data.pageTotal);r||(r=0),s.userPageTotal=r,s.userLoading=!1}else s.$message.error("数据查询失败，请联系管理员！");else s.userLoading=!1,s.$message.error("数据查询失败，请联系管理员！")}))):"permission"===e&&(this.$set(this.permissionQuery,"roleId",this.roleForm.roleId),this.$api.get("/searchAllPermissionInfoInRole",{query:this.permissionQuery},(function(e){if(e.status>=200&&e.status<300)if("true"==e.data.success){s.permissionData=e.data.data;var r=Number(e.data.pageTotal);r||(r=0),s.permissionPageTotal=r,s.permissionLoading=!1}else s.permissionLoading=!1,s.$message.error("数据查询失败，请联系管理员！");else s.permissionLoading=!1,s.$message.error("数据查询失败，请联系管理员！")})))},resetForm:function(e){this.$refs[e].resetFields()},handlePermissionSelectionChange:function(e){this.permissionMultipleSelection=e},handlePermissionPageChange:function(e){this.permissionLoading=!0,this.$set(this.permissionQuery,"pageIndex",e),this.selectInfoInRole("permission")},handlePermissionSearch:function(){this.permissionLoading=!0,this.$set(this.permissionQuery,"pageIndex",1),this.selectInfoInRole("permission")},deletePermission:function(){var e=this;this.permissionLoading=!0,this.$api.post("/deletePermissionsInfoInRole",{permissionInfo:JSON.stringify(this.permissionMultipleSelection),roleId:this.roleForm.roleId},(function(s){s.status>=200&&s.status<300&&"true"==s.data.success?(e.$message.success(s.data.msg),e.selectInfoInRole("permission")):(e.permissionLoading=!1,e.$message.error(s.data.msg))}))},createPermission:function(){this.dialogPermissionFormVisible=!0},handleUserSelectionChange:function(e){this.userMultipleSelection=e},handleUserPageChange:function(e){this.userLoading=!0,this.$set(this.userQuery,"pageIndex",e),this.selectInfoInRole("user")},handleUserSearch:function(){this.userLoading=!0,this.$set(this.userQuery,"pageIndex",1),this.selectInfoInRole("user")},deleteUser:function(){var e=this;this.userLoading=!0,this.$api.post("/deleteUsersInfoInRole",{userInfo:JSON.stringify(this.userMultipleSelection),roleId:this.roleForm.roleId},(function(s){s.status>=200&&s.status<300&&"true"==s.data.success?(e.$message.success(s.data.msg),e.selectInfoInRole("user")):(e.userLoading=!1,e.$message.error(s.data.msg))}))},createUser:function(){this.dialogUserFormVisible=!0}}}),o=a,l=(r("f89c"),r("2877")),n=Object(l["a"])(o,t,i,!1,null,"6846d550",null);s["default"]=n.exports},b25c:function(e,s,r){},f89c:function(e,s,r){"use strict";var t=r("b25c"),i=r.n(t);i.a}}]);